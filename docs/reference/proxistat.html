<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>DRAFT - Create a custom proximity score for every block group, representing count and proximity of specified points Indicator of proximity of residents in each US blockgroup to a custom set of facilities or sites — proxistat • EJAM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="DRAFT - Create a custom proximity score for every block group, representing count and proximity of specified points Indicator of proximity of residents in each US blockgroup to a custom set of facilities or sites — proxistat"><meta name="description" content="DRAFT - Create a custom proximity score for every block group, representing count and proximity of specified points
Indicator of proximity of residents in each US blockgroup to a custom set of facilities or sites"><meta property="og:description" content="DRAFT - Create a custom proximity score for every block group, representing count and proximity of specified points
Indicator of proximity of residents in each US blockgroup to a custom set of facilities or sites"><meta property="og:image" content="https://usepa.github.io/EJAM-open/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EJAM</a>

    <small class="nav-text text-warning me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.32.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Overview for EJAM Users</h6></li>
    <li><a class="dropdown-item" href="../articles/0_whatis.html">What is EJAM?</a></li>
    <li><a class="dropdown-item" href="../articles/0_webapp.html">Accessing the Web App</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>For analysts using R</h6></li>
    <li><a class="dropdown-item" href="../articles/1_installing.html">Installing the EJAM R package</a></li>
    <li><a class="dropdown-item" href="../articles/2_quickstart.html">Quick Start Guide</a></li>
    <li><a class="dropdown-item" href="../articles/3_analyzing.html">Using EJAM for Analysis in R</a></li>
    <li><a class="dropdown-item" href="../articles/testdata.html">Examples of Input/Output Files &amp; Data</a></li>
    <li><a class="dropdown-item" href="../articles/distances.html">Comparing Distances (Choosing a Radius)</a></li>
    <li><a class="dropdown-item" href="../articles/naics.html">NAICS (Industries)</a></li>
    <li><a class="dropdown-item" href="../articles/zipcodes.html">Zipcodes</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>For package/app developers</h6></li>
    <li><a class="dropdown-item" href="../articles/dev_deploy-app.html">Deploying the Web App</a></li>
    <li><a class="dropdown-item" href="../articles/dev_run-shinytests.html">Testing EJAM App with shinytest2</a></li>
    <li><a class="dropdown-item" href="../articles/dev_run-unit-tests.html">Testing EJAM Functions with Unit Tests</a></li>
    <li><a class="dropdown-item" href="../articles/dev_update-datasets.html">Updating EJAM Datasets</a></li>
    <li><a class="dropdown-item" href="../articles/dev_update_documentation.html">Updating Documentation</a></li>
    <li><a class="dropdown-item" href="../articles/dev_update-package.html">Updating the Package as a New Release</a></li>
    <li><a class="dropdown-item" href="../articles/dev_future_plans.html">Future Plans and Ideas for EJAM</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>DRAFT - Create a custom proximity score for every block group, representing count and proximity of specified points Indicator of proximity of residents in each US blockgroup to a custom set of facilities or sites</h1>
      <small class="dont-index">Source: <a href="https://github.com/USEPA/EJAM-open/blob/HEAD/R/PROXIMITY_FUNCTIONS.R" class="external-link"><code>R/PROXIMITY_FUNCTIONS.R</code></a></small>
      <div class="d-none name"><code>proxistat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>DRAFT - Create a custom proximity score for every block group, representing count and proximity of specified points
Indicator of proximity of residents in each US blockgroup to a custom set of facilities or sites</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">proxistat</span><span class="op">(</span></span>
<span>  <span class="va">topoints</span>,</span>
<span>  bpoints <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  blocks_per_batch <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  countradius <span class="op">=</span> <span class="fl">3.106856</span>,</span>
<span>  maxradius <span class="op">=</span> <span class="fl">621.3712</span>,</span>
<span>  avoidorphans <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  quadtree <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quaddatatable <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-topoints">topoints<a class="anchor" aria-label="anchor" href="#arg-topoints"></a></dt>
<dd><p>Representing nearby amenities or hazards counted by the proximity scores –
such as Superfund NPL sites used for a NPL proximity score –
a data.table of lat lon, all points representing some amenity or hazard that
the proximity score indicates proximity to. It could be a subset of the <a href="frs.html">frs</a> table, e.g.</p></dd>


<dt id="arg-bpoints">bpoints<a class="anchor" aria-label="anchor" href="#arg-bpoints"></a></dt>
<dd><p>Representing places to be assigned proximity scores –
such as <a href="blockpoints.html">blockpoints</a>, the centroid/internal point of every block in the USA –
a data.table of Census block points lat lon, representing where residents are,
for the entire US (or at least a whole State, for example – it should be all blocks for which you need a proximity score).
The score is calculated for a given block based on all topoints near the block,
and then summarized over all blocks in a given block group to create a score for that block group.</p></dd>


<dt id="arg-blocks-per-batch">blocks_per_batch<a class="anchor" aria-label="anchor" href="#arg-blocks-per-batch"></a></dt>
<dd><p>number of blocks to process in each batch, defaults to 1000</p></dd>


<dt id="arg-countradius">countradius<a class="anchor" aria-label="anchor" href="#arg-countradius"></a></dt>
<dd><p>distance within in which nearby sites are counted to create proximity score.
In miles, and default is 5 km (5000 / meters_per_mile = 3.106856 miles)
which is the EJScreen zone for proximity scores based on counts.</p></dd>


<dt id="arg-maxradius">maxradius<a class="anchor" aria-label="anchor" href="#arg-maxradius"></a></dt>
<dd><p>max distance in miles to search for nearest single facility,
if none found within countradius. EJScreen seems to use 1,000 km as the max to search,
since the lowest scores for proximity scores of RMP, TSDF, or NPL are ROUGHLY 0.001,
(exactly 0.000747782)
meaning approx. 1/1000 km and km_per_mile = 1.609344 = meters_per_mile / 1000
so 1000 km is 1000 / 1.609344 = 621.3712 miles.
However, the exact min value implies 1337.288 kilometers, or 830.9523 miles?</p></dd>


<dt id="arg-avoidorphans">avoidorphans<a class="anchor" aria-label="anchor" href="#arg-avoidorphans"></a></dt>
<dd><p>(as in getblocksnearby() but may not be implemented or working yet)</p></dd>


<dt id="arg-quadtree">quadtree<a class="anchor" aria-label="anchor" href="#arg-quadtree"></a></dt>
<dd><p>Index of sites such as facilities that will be the basis for the proximity scores.
Optional, because it can be created here on the fly based on pts parameter,
but can pass it if already exists - an index of block locations,
built during use of EJAM package. create_quaddata()</p></dd>


<dt id="arg-quaddatatable">quaddatatable<a class="anchor" aria-label="anchor" href="#arg-quaddatatable"></a></dt>
<dd><p>optional, created from pts if not passed,
created by create_quaddata() utility, and used to create quadtree</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>data.table of block groups, with proximityscore, bgfips, lat, lon, etc.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Tries to use getpointsnearby() for one batch of blocks at a time,
finding user-specified sites nearby those blocks
(for each block, get distance FROM a block TO any nearby user-specified SITE points).
The inverse approach compared to <code><a href="proxistat_via_getblocks.html">proxistat_via_getblocks()</a></code></p>
<p>A "facility" proximity score for the residents in one place is an indicator of
how far away those facilities are, and how many there are nearby - it accounts
for the number of facilities within 5 kilometers (facility density)
and the distance of each (proximity). If there are more points nearby, and/or the
points are closer to the average resident in a blockgroup, that
blockgroup gets a higher proximity score.</p>
<p>The formula for this proximity score is the sum of (1/d)
where each d is distance of a given site in kilometers,
summed over all sites that are within 5 km (or the single
closest site if none are within 5 km), just as in EJScreen proximity scores
like the TSDF or RMP scores.</p>
<p>Any custom user-provided set of points can be turned into a proximity score,
such as locations of all industrial sites of a certain type,
or all grocery stores, or all schools. A proximity score can be
created for all blocks and block groups in the US (or just one State or Region).
Then the proximity scores can be analyzed in a tool like EJAM, just as the
existing pre-calculated proximity scores are analyzed to represent the
number of nearby hazardous waste treatment storage and disposal facilities,
weighted by how far away each one is, as provided in the EJScreen proximity
score for TSDFs.</p>
<p>A custom user-specified proximity score might focus on schools, for example.
The schools proximity score could be analyzed in EJAM for one or more communities,
or areas near regulated facilities, or any set of analyzed places.
That would provide statistics demonstrating which places have more schools
closer to them (or inside the areas defined by polygons or FIPS codes, for example).</p>
<p>To create the proximity score, EJAM uses the same method EJScreen used
to create proximity scores. The specified points first get indexed
by a utility function called indexpoints() and are searched for and counted near
every block and blockgroup in the US via a function called getpointsnearby().</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span></span>
<span> <span class="co">### see test data in test-proxistat.R</span></span>
<span></span>
<span> <span class="co"># pts &lt;- testpoints_1000</span></span>
<span> <span class="co"># x &lt;- proxistat(topoints = pts)</span></span>
<span> <span class="co">#</span></span>
<span> <span class="co"># summary(x$proximityscore)</span></span>
<span> <span class="co"># # analyze.stuff   pctiles(x$proximityscore)</span></span>
<span> <span class="co">#</span></span>
<span> <span class="co"># plot(x = x$lon, y = x$lat)</span></span>
<span> <span class="co"># tops = x$proximityscore &gt; 500 &amp; !is.infinite(x$proximityscore) &amp; !is.na(x$proximityscore)</span></span>
<span> <span class="co"># points(x = x$lon[tops], y = x$lat[tops], col="red")</span></span>
<span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>2025</p>
</div>

<div class="pkgdown-footer-right">
  <p>EJAM Version 2.32.3</p>
</div>

    </footer></div>





  </body></html>

