<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>What percentage of this group's population lives less than X miles from a site? — *** DRAFT - NEED TO RECHECK CALCULATIONS — plot_distance_by_pctd • EJAM</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="What percentage of this group's population lives less than X miles from a site? — *** DRAFT - NEED TO RECHECK CALCULATIONS — plot_distance_by_pctd"><meta name="description" content="*** DRAFT - NEED TO RECHECK CALCULATIONS
This plots the cumulative share of residents found within each distance,
for a single population group."><meta property="og:description" content="*** DRAFT - NEED TO RECHECK CALCULATIONS
This plots the cumulative share of residents found within each distance,
for a single population group."><meta property="og:image" content="https://usepa.github.io/EJAM-open/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EJAM</a>

    <small class="nav-text text-warning me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.32.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Overview for EJAM Users</h6></li>
    <li><a class="dropdown-item" href="../articles/0_whatis.html">What is EJAM?</a></li>
    <li><a class="dropdown-item" href="../articles/0_webapp.html">Accessing the Web App</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>For analysts using R</h6></li>
    <li><a class="dropdown-item" href="../articles/1_installing.html">Installing the EJAM R package</a></li>
    <li><a class="dropdown-item" href="../articles/2_quickstart.html">Quick Start Guide</a></li>
    <li><a class="dropdown-item" href="../articles/3_analyzing.html">Using EJAM for Analysis in R</a></li>
    <li><a class="dropdown-item" href="../articles/testdata.html">Examples of Input/Output Files &amp; Data</a></li>
    <li><a class="dropdown-item" href="../articles/distances.html">Comparing Distances (Choosing a Radius)</a></li>
    <li><a class="dropdown-item" href="../articles/naics.html">NAICS (Industries)</a></li>
    <li><a class="dropdown-item" href="../articles/zipcodes.html">Zipcodes</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>For package/app developers</h6></li>
    <li><a class="dropdown-item" href="../articles/dev_deploy-app.html">Deploying the Web App</a></li>
    <li><a class="dropdown-item" href="../articles/dev_run-shinytests.html">Testing EJAM App with Shinytests</a></li>
    <li><a class="dropdown-item" href="../articles/dev_run-unit-tests.html">Testing EJAM Functions with Unit Tests</a></li>
    <li><a class="dropdown-item" href="../articles/dev_update-datasets.html">Updating EJAM Datasets</a></li>
    <li><a class="dropdown-item" href="../articles/dev_update_documentation.html">Updating Documentation</a></li>
    <li><a class="dropdown-item" href="../articles/dev_update-package.html">Updating the Package as a New Release</a></li>
    <li><a class="dropdown-item" href="../articles/dev_future_plans.html">Future Plans and Ideas for EJAM</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>What percentage of this group's population lives less than X miles from a site? — *** DRAFT - NEED TO RECHECK CALCULATIONS</h1>
      <small class="dont-index">Source: <a href="https://github.com/USEPA/EJAM-open/blob/main/R/plot_distance_by_pctd.R" class="external-link"><code>R/plot_distance_by_pctd.R</code></a></small>
      <div class="d-none name"><code>plot_distance_by_pctd.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>*** DRAFT - NEED TO RECHECK CALCULATIONS
This plots the cumulative share of residents found within each distance,
for a single population group.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_distance_by_pctd</span><span class="op">(</span></span>
<span>  s2b <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sitenumber <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  score_colname <span class="op">=</span> <span class="va">names_these</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>  scorewts_colname <span class="op">=</span> <span class="st">"pop"</span>,</span>
<span>  score_label <span class="op">=</span> <span class="fu"><a href="fixcolnames.html">fixcolnames</a></span><span class="op">(</span><span class="va">score_colname</span>, <span class="st">"r"</span>, <span class="st">"shortlabel"</span><span class="op">)</span>,</span>
<span>  radius <span class="op">=</span> <span class="fl">30</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-s-b">s2b<a class="anchor" aria-label="anchor" href="#arg-s-b"></a></dt>
<dd><p>output of <code><a href="getblocksnearby.html">getblocksnearby()</a></code>, or else can be
a table of points with lat,lon columns and 1 row per point.
If NULL (not provided as a parameter to the function),
will prompt for a file to upload and use, if interactive() is TRUE, or else
the function will just show an example using a random point.</p></dd>


<dt id="arg-sitenumber">sitenumber<a class="anchor" aria-label="anchor" href="#arg-sitenumber"></a></dt>
<dd><p>If used, one number that is the unique ID
(the row number of original list of points) to look at in s2b.
This should be the same as the value of s2b$ejam_uniq_id for
the site to be analyzed.
Will be able to omit or set to NULL to use overall aggregate of all sites.</p></dd>


<dt id="arg-score-colname">score_colname<a class="anchor" aria-label="anchor" href="#arg-score-colname"></a></dt>
<dd><p>colname in blockgroupstats for an indicator to be
aggregated across blocks and blockgroups as a weighted mean</p></dd>


<dt id="arg-scorewts-colname">scorewts_colname<a class="anchor" aria-label="anchor" href="#arg-scorewts-colname"></a></dt>
<dd><p>colname in blockgroupstats – like "pop" – for the weight
to use in aggregating the scores referred to by score_colname</p></dd>


<dt id="arg-score-label">score_label<a class="anchor" aria-label="anchor" href="#arg-score-label"></a></dt>
<dd><p>optional friendly label for the variable</p></dd>


<dt id="arg-radius">radius<a class="anchor" aria-label="anchor" href="#arg-radius"></a></dt>
<dd><p>optional radius to use as maximum analyzed or shown –
if s2b was provided, this caps what is used and only shorter radii get shown
(only relevant if s2b had radii larger than this radius parameter)
and if s2b is not provided, interactively RStudio user is prompted
to provide latlon file to analyze in getblocksnearby() and
radius is used in that.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>returns s2b but with more columns in it like wtdmean_within</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Also see ejamit_compare_distances() for a plot  of several indicators at several distances!</p>
<p>This function uses the distance of each Census block from the site in conjunction with
the block group residential population data, to provide a relatively detailed picture of
how far away residents in each group live. In contrast, the function
<code><a href="distance_by_group_plot.html">distance_cdf_by_group_plot()</a></code> is based on ejamit()$results_bybg_people,
which provides only block group resolution information about distance.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># Example of area where %Black is</span></span></span>
<span class="r-in"><span> <span class="co"># very high within 1 mile but drops by 3 miles away</span></span></span>
<span class="r-in"><span> <span class="va">pts</span> <span class="op">=</span> <span class="va">testpoints_100</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="fu">plot_distance_by_pctd</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="getblocksnearby.html">getblocksnearby</a></span><span class="op">(</span><span class="va">pts</span>, radius <span class="op">=</span> <span class="fl">10</span>, quiet <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    score_colname <span class="op">=</span> <span class="st">"pctnhba"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>aggregate of multiple sites not yet implemented - using site #1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analyzing 1 points, radius of 10 miles around each.</span>
<span class="r-plt img"><img src="plot_distance_by_pctd-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Index: &lt;ejam_uniq_id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         bgid ejam_uniq_id blockid  distance     blockwt distance_unadjusted</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;int&gt;        &lt;int&gt;   &lt;int&gt;     &lt;num&gt;       &lt;num&gt;               &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1: 187138            1 6179733 0.2643867 0.003177966           0.2643867</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2: 187138            1 6179731 0.3041297 0.018008475           0.3041297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3: 187138            1 6179734 0.5242682 0.005296610           0.5242682</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4: 187138            1 6179721 0.5424342 0.221398305           0.5424342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5: 187138            1 6179720 0.5875761 0.085805085           0.5875761</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1368: 187128            1 6179166 9.9673004 0.036414566           9.9673004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1369: 187205            1 6182570 9.9679871 0.019101124           9.9679871</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1370: 187168            1 6181251 9.9747066 0.038843722           9.9747066</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1371: 184226            1 6070291 9.9794941 0.021573604           9.9794941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1372: 187182            1 6181861 9.9911461 0.003802281           9.9911461</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          pctnhba   pop scorewts     scores wtdmean_within</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            &lt;num&gt; &lt;num&gt;    &lt;num&gt;      &lt;num&gt;          &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1: 0.00000000   873      873 0.00000000    0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2: 0.00000000   873      873 0.00000000    0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3: 0.00000000   873      873 0.00000000    0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4: 0.00000000   873      873 0.00000000    0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5: 0.00000000   873      873 0.00000000    0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1368: 0.00000000   681      681 0.00000000    0.009531812</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1369: 0.17471737   973      973 0.17471737    0.009616631</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1370: 0.01736385  1267     1267 0.01736385    0.009627151</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1371: 0.00000000   741      741 0.00000000    0.009622907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1372: 0.06965174  1407     1407 0.06965174    0.009631762</span>
<span class="r-in"><span> <span class="co">#browseURL(url_ejscreen_report(lat = pts$lat, lon = pts$lon, radius = 0.5))</span></span></span>
<span class="r-in"><span> <span class="co">#browseURL(url_ejscreen_report(lat = pts$lat, lon = pts$lon, radius = 3))</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="co"># Example of area that has higher %Hispanic as you go </span></span></span>
<span class="r-in"><span> <span class="co"># 10 to 30 miles away from this specific point</span></span></span>
<span class="r-in"><span> <span class="va">pts</span> <span class="op">=</span> <span class="fu">data.table</span><span class="op">(</span>lat <span class="op">=</span> <span class="fl">45.75464</span>, lon <span class="op">=</span> <span class="op">-</span><span class="fl">94.36791</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in data.table(lat = 45.75464, lon = -94.36791):</span> could not find function "data.table"</span>
<span class="r-in"><span> <span class="fu">plot_distance_by_pctd</span><span class="op">(</span><span class="va">pts</span>,</span></span>
<span class="r-in"><span>   sitenumber <span class="op">=</span> <span class="fl">1</span>, score_colname <span class="op">=</span> <span class="st">"pcthisp"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analyzing 1 points, radius of 30 miles around each.</span>
<span class="r-plt img"><img src="plot_distance_by_pctd-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Index: &lt;ejam_uniq_id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          bgid ejam_uniq_id blockid   distance     blockwt distance_unadjusted</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;int&gt;        &lt;int&gt;   &lt;int&gt;      &lt;num&gt;       &lt;num&gt;               &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1: 187138            1 6179733  0.2643867 0.003177966           0.2643867</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2: 187138            1 6179731  0.3041297 0.018008475           0.3041297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3: 187138            1 6179734  0.5242682 0.005296610           0.5242682</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4: 187138            1 6179721  0.5424342 0.221398305           0.5424342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5: 187138            1 6179720  0.5875761 0.085805085           0.5875761</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ---                                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15730: 184186            1 6068740 29.9953022 0.005107252          29.9953022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15731: 171499            1 5535848 29.9969425 0.111866502          29.9969425</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15732: 171420            1 5533382 29.9976559 0.002803738          29.9976559</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15733: 174003            1 5619136 29.9987164 0.006139678          29.9987164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15734: 184161            1 6067284 29.9989281 0.011421320          29.9989281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           pcthisp   pop scorewts     scores wtdmean_within</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             &lt;num&gt; &lt;num&gt;    &lt;num&gt;      &lt;num&gt;          &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1: 0.00000000   873      873 0.00000000     0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2: 0.00000000   873      873 0.00000000     0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3: 0.00000000   873      873 0.00000000     0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4: 0.00000000   873      873 0.00000000     0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5: 0.00000000   873      873 0.00000000     0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ---                                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15730: 0.01766438  1019     1019 0.01766438     0.03446624</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15731: 0.02892341  1867     1867 0.02892341     0.03446443</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15732: 0.05194805  2233     2233 0.05194805     0.03446460</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15733: 0.06814701  1306     1306 0.06814701     0.03446502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15734: 0.00000000   801      801 0.00000000     0.03446453</span>
<span class="r-in"><span> <span class="co"># browseURL(url_ejscreen_report(lat = pts$lat, lon = pts$lon, radius = 10))</span></span></span>
<span class="r-in"><span> <span class="co"># browseURL(url_ejscreen_report(lat = pts$lat, lon = pts$lon, radius = 30))</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>2025</p>
</div>

<div class="pkgdown-footer-right">
  <p>EJAM Version 2.32.3</p>
</div>

    </footer></div>





  </body></html>

